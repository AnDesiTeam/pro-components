"use strict";(self.webpackChunkpro_components=self.webpackChunkpro_components||[]).push([[4275],{44275:function(rr,he,t){t.d(he,{L:function(){return V},b:function(){return G}});var pe=t(52510),E=t.n(pe),ge=t(57213),u=t.n(ge),Se=t(25359),A=t.n(Se),Fe=t(49811),_=t.n(Fe),xe=t(93525),ee=t.n(xe),ye=t(54306),N=t.n(ye),Re=t(12342),re=t.n(Re),ne=t(43502),Ce=t(12930),Pe=t(61375),z=t(95852),je=t(59586),H=t(89372),W=t(22789),Me=t(75854),te=t(39801),J=t(8562),De=t(47583),oe=t(47215),Ze=t(97754),se=t.n(Ze),Ae=t(38606),We=t(44797),a=t(50959),$e=t(5795),be=t(44718),i=t(11527),Ie=["onFinish","step","formRef","title","stepProps"];function Be(o){var c=(0,a.useRef)(),n=(0,a.useContext)(G),m=o.onFinish,$=o.step,Y=o.formRef,S=o.title,Ge=o.stepProps,j=re()(o,Ie);return(0,$e.noteOnce)(!j.submitter,"StepForm \u4E0D\u5305\u542B\u63D0\u4EA4\u6309\u94AE\uFF0C\u8BF7\u5728 StepsForm \u4E0A"),(0,a.useImperativeHandle)(Y,function(){return c.current}),(0,a.useEffect)(function(){if(o.name||o.step){var r=(o.name||o.step).toString();return n==null||n.regForm(r,o),function(){n==null||n.unRegForm(r)}}},[]),n&&n!==null&&n!==void 0&&n.formArrayRef&&(n.formArrayRef.current[$||0]=c),(0,i.jsx)(be.I,u()({formRef:c,onFinish:function(){var r=_()(A()().mark(function F(y){var M;return A()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(j.name&&(n==null||n.onFormFinish(j.name,y)),!m){p.next=9;break}return n==null||n.setLoading(!0),p.next=5,m==null?void 0:m(y);case 5:return M=p.sent,M&&(n==null||n.next()),n==null||n.setLoading(!1),p.abrupt("return");case 9:n!=null&&n.lastStep||n==null||n.next();case 10:case"end":return p.stop()}},F)}));return function(F){return r.apply(this,arguments)}}(),layout:"vertical"},j))}var Le=Be,Te=t(2072),Ee=function(c){return E()({},c.componentCls,{"&-container":{width:"max-content",minWidth:"520px",maxWidth:"100%",margin:"auto"},"&-steps-container":E()({maxWidth:"1160px",margin:"auto"},"".concat(c.antCls,"-steps-vertical"),{height:"100%"}),"&-step":{display:"none",marginBlockStart:"32px","&-active":{display:"block"},"> form":{maxWidth:"100%"}}})};function Ne(o){return(0,Te.Xj)("StepsForm",function(c){var n=u()(u()({},c),{},{componentCls:".".concat(o)});return[Ee(n)]})}var ze=["current","onCurrentChange","submitter","stepsFormRender","stepsRender","stepFormRender","stepsProps","onFinish","formProps","containerStyle","formRef","formMapRef"],G=a.createContext(void 0),He={horizontal:function(c){var n=c.stepsDom,m=c.formDom;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(H.Z,{gutter:{xs:8,sm:16,md:24},children:(0,i.jsx)(W.Z,{span:24,children:n})}),(0,i.jsx)(H.Z,{gutter:{xs:8,sm:16,md:24},children:(0,i.jsx)(W.Z,{span:24,children:m})})]})},vertical:function(c){var n=c.stepsDom,m=c.formDom;return(0,i.jsxs)(H.Z,{align:"stretch",wrap:!0,gutter:{xs:8,sm:16,md:24},children:[(0,i.jsx)(W.Z,{xxl:4,xl:6,lg:7,md:8,sm:10,xs:12,children:a.cloneElement(n,{style:{height:"100%"}})}),(0,i.jsx)(W.Z,{children:(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",width:"100%",height:"100%"},children:m})})]})}};function Je(o){var c=(0,a.useContext)(Me.ZP.ConfigContext),n=c.getPrefixCls,m=n("pro-steps-form"),$=Ne(m),Y=$.wrapSSR,S=$.hashId,Ge=o.current,j=o.onCurrentChange,r=o.submitter,F=o.stepsFormRender,y=o.stepsRender,M=o.stepFormRender,g=o.stepsProps,p=o.onFinish,ae=o.formProps,ie=o.containerStyle,Ve=o.formRef,Ye=o.formMapRef,Oe=re()(o,ze),O=(0,a.useRef)(new Map),x=(0,a.useRef)(new Map),R=(0,a.useRef)([]),Xe=(0,a.useState)([]),ue=N()(Xe,2),h=ue[0],le=ue[1],Ke=(0,a.useState)(!1),ve=N()(Ke,2),D=ve[0],b=ve[1],C=(0,ne.YB)(),Qe=(0,We.default)(0,{value:o.current,onChange:o.onCurrentChange}),me=N()(Qe,2),d=me[0],I=me[1],X=(0,a.useMemo)(function(){return He[(g==null?void 0:g.direction)||"horizontal"]},[g==null?void 0:g.direction]),K=(0,a.useMemo)(function(){return d===h.length-1},[h.length,d]),Ue=(0,a.useCallback)(function(e,s){x.current.has(e)||le(function(v){return[].concat(ee()(v),[e])}),x.current.set(e,s)},[]),ke=(0,a.useCallback)(function(e){le(function(s){return s.filter(function(v){return v!==e})}),x.current.delete(e),O.current.delete(e)},[]);(0,a.useImperativeHandle)(Ye,function(){return R.current}),(0,a.useImperativeHandle)(Ve,function(){var e;return(e=R.current[d||0])===null||e===void 0?void 0:e.current},[d]);var we=(0,a.useCallback)(function(){var e=_()(A()().mark(function s(v,l){var Z,T;return A()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(O.current.set(v,l),!(!K||!p)){f.next=3;break}return f.abrupt("return");case 3:return b(!0),Z=Ce.T.apply(void 0,[{}].concat(ee()(Array.from(O.current.values())))),f.prev=5,f.next=8,p(Z);case 8:T=f.sent,T&&(I(0),R.current.forEach(function(er){var q;return(q=er.current)===null||q===void 0?void 0:q.resetFields()})),f.next=15;break;case 12:f.prev=12,f.t0=f.catch(5),console.log(f.t0);case 15:return f.prev=15,b(!1),f.finish(15);case 18:case"end":return f.stop()}},s,null,[[5,12,15,18]])}));return function(s,v){return e.apply(this,arguments)}}(),[K,p,b,I]),Q=(0,a.useMemo)(function(){var e=(0,Pe.n)(je.Z,"4.24.0")>-1,s=e?{items:h.map(function(v){var l=x.current.get(v);return u()({key:v,title:l==null?void 0:l.title},l==null?void 0:l.stepProps)})}:{};return(0,i.jsx)("div",{className:"".concat(m,"-steps-container ").concat(S),style:{maxWidth:Math.min(h.length*320,1160)},children:(0,i.jsx)(te.Z,u()(u()(u()({},g),s),{},{current:d,onChange:void 0,children:!e&&h.map(function(v){var l=x.current.get(v);return(0,i.jsx)(te.Z.Step,u()({title:l==null?void 0:l.title},l==null?void 0:l.stepProps),v)})}))})},[h,S,m,d,g]),P=(0,z.J)(function(){var e,s=R.current[d];(e=s.current)===null||e===void 0||e.submit()}),B=(0,z.J)(function(){d<1||I(d-1)}),U=(0,a.useMemo)(function(){return r!==!1&&(0,i.jsx)(J.ZP,u()(u()({type:"primary",loading:D},r==null?void 0:r.submitButtonProps),{},{onClick:function(){var s;r==null||(s=r.onSubmit)===null||s===void 0||s.call(r),P()},children:C.getMessage("stepsForm.next","\u4E0B\u4E00\u6B65")}),"next")},[C,D,P,r]),k=(0,a.useMemo)(function(){return r!==!1&&(0,i.jsx)(J.ZP,u()(u()({},r==null?void 0:r.resetButtonProps),{},{onClick:function(){var s;B(),r==null||(s=r.onReset)===null||s===void 0||s.call(r)},children:C.getMessage("stepsForm.prev","\u4E0A\u4E00\u6B65")}),"pre")},[C,B,r]),w=(0,a.useMemo)(function(){return r!==!1&&(0,i.jsx)(J.ZP,u()(u()({type:"primary",loading:D},r==null?void 0:r.submitButtonProps),{},{onClick:function(){var s;r==null||(s=r.onSubmit)===null||s===void 0||s.call(r),P()},children:C.getMessage("stepsForm.submit","\u63D0\u4EA4")}),"submit")},[C,D,P,r]),qe=(0,z.J)(function(){d>h.length-2||I(d+1)}),L=(0,a.useMemo)(function(){var e=[],s=d||0;if(s<1?h.length===1?e.push(w):e.push(U):s+1===h.length?e.push(k,w):e.push(k,U),e=e.filter(a.isValidElement),r&&r.render){var v,l={form:(v=R.current[d])===null||v===void 0?void 0:v.current,onSubmit:P,step:d,onPre:B};return r.render(l,e)}return r&&(r==null?void 0:r.render)===!1?null:e},[h.length,U,P,k,B,d,w,r]),de=(0,a.useMemo)(function(){return(0,Ae.default)(o.children).map(function(e,s){var v=e.props,l=v.name||"".concat(s),Z=d===s,T=Z?{contentRender:M,submitter:!1}:{};return(0,i.jsx)("div",{className:se()("".concat(m,"-step"),S,E()({},"".concat(m,"-step-active"),Z)),children:a.cloneElement(e,u()(u()(u()(u()({},T),ae),v),{},{name:l,step:s,key:l}))},l)})},[ae,S,m,o.children,d,M]),ce=(0,a.useMemo)(function(){return y?y(h.map(function(e){var s;return{key:e,title:(s=x.current.get(e))===null||s===void 0?void 0:s.title}}),Q):Q},[h,Q,y]),fe=(0,a.useMemo)(function(){return(0,i.jsxs)("div",{className:"".concat(m,"-container ").concat(S),style:ie,children:[de,F?null:(0,i.jsx)(De.Z,{children:L})]})},[ie,de,S,m,F,L]),_e=(0,a.useMemo)(function(){var e={stepsDom:ce,formDom:fe};return F?F(X(e),L):X(e)},[ce,fe,X,F,L]);return Y((0,i.jsx)("div",{className:se()(m,S),children:(0,i.jsx)(oe.Z.Provider,u()(u()({},Oe),{},{children:(0,i.jsx)(G.Provider,{value:{loading:D,setLoading:b,regForm:Ue,keyArray:h,next:qe,formArrayRef:R,formMapRef:x,lastStep:K,unRegForm:ke,onFormFinish:we},children:_e})}))}))}function V(o){return(0,i.jsx)(ne._Y,{needDeps:!0,children:(0,i.jsx)(Je,u()({},o))})}V.StepForm=Le,V.useForm=oe.Z.useForm}}]);
