"use strict";(self.webpackChunkpro_components=self.webpackChunkpro_components||[]).push([[4543],{14543:function(tr,he,n){n.d(he,{U9:function(){return O},L0:function(){return U},bg:function(){return Y}});var ge=n(52510),z=n.n(ge),Se=n(57213),u=n.n(Se),Fe=n(25359),W=n.n(Fe),xe=n(49811),ne=n.n(xe),ye=n(93525),te=n.n(ye),Re=n(54306),H=n.n(Re),Ce=n(12342),oe=n.n(Ce),se=n(94511),Pe=n(41551),je=n(76963),J=n(11039),G=n(44334),T=n(10994),Me=n(91281),Ze=n(29980),ae=n(54420),V=n(59649),De=n(14301),ie=n(16146),Ae=n(84875),ue=n.n(Ae),Ie=n(96786),$e=n(66613),s=n(50959),We=n(71770),Te=n(51071),be=n(50571),a=n(11527),Be=["onFinish","step","formRef","title","stepProps"];function Le(i){var m=(0,s.useRef)(),e=(0,s.useContext)(Y),c=(0,s.useContext)(O),p=u()(u()({},i),c),M=p.onFinish,F=p.step,A=p.formRef,Ye=p.title,t=p.stepProps,h=oe()(p,Be);return(0,Te.noteOnce)(!h.submitter,"StepForm \u4E0D\u5305\u542B\u63D0\u4EA4\u6309\u94AE\uFF0C\u8BF7\u5728 StepsForm \u4E0A"),(0,s.useImperativeHandle)(A,function(){return m.current},[A==null?void 0:A.current]),(0,s.useEffect)(function(){if(p.name||p.step){var R=(p.name||p.step).toString();return e==null||e.regForm(R,p),function(){e==null||e.unRegForm(R)}}},[]),e&&e!==null&&e!==void 0&&e.formArrayRef&&(e.formArrayRef.current[F||0]=m),(0,a.jsx)(be.I,u()({formRef:m,onFinish:function(){var R=ne()(W()().mark(function P(g){var x;return W()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(h.name&&(e==null||e.onFormFinish(h.name,g)),!M){y.next=9;break}return e==null||e.setLoading(!0),y.next=5,M==null?void 0:M(g);case 5:return x=y.sent,x&&(e==null||e.next()),e==null||e.setLoading(!1),y.abrupt("return");case 9:e!=null&&e.lastStep||e==null||e.next();case 10:case"end":return y.stop()}},P)}));return function(P){return R.apply(this,arguments)}}(),onInit:function(P,g){var x;m.current=g,e&&e!==null&&e!==void 0&&e.formArrayRef&&(e.formArrayRef.current[F||0]=m),h==null||(x=h.onInit)===null||x===void 0||x.call(h,P,g)},layout:"vertical"},(0,We.Z)(h,["layoutType","columns"])))}var Ne=Le,Ee=n(11070),ze=function(m){return z()({},m.componentCls,{"&-container":{width:"max-content",minWidth:"420px",maxWidth:"100%",margin:"auto"},"&-steps-container":z()({maxWidth:"1160px",margin:"auto"},"".concat(m.antCls,"-steps-vertical"),{height:"100%"}),"&-step":{display:"none",marginBlockStart:"32px","&-active":{display:"block"},"> form":{maxWidth:"100%"}}})};function He(i){return(0,Ee.Xj)("StepsForm",function(m){var e=u()(u()({},m),{},{componentCls:".".concat(i)});return[ze(e)]})}var Je=["current","onCurrentChange","submitter","stepsFormRender","stepsRender","stepFormRender","stepsProps","onFinish","formProps","containerStyle","formRef","formMapRef"],Y=s.createContext(void 0),Ge={horizontal:function(m){var e=m.stepsDom,c=m.formDom;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(G.Z,{gutter:{xs:8,sm:16,md:24},children:(0,a.jsx)(T.Z,{span:24,children:e})}),(0,a.jsx)(G.Z,{gutter:{xs:8,sm:16,md:24},children:(0,a.jsx)(T.Z,{span:24,children:c})})]})},vertical:function(m){var e=m.stepsDom,c=m.formDom;return(0,a.jsxs)(G.Z,{align:"stretch",wrap:!0,gutter:{xs:8,sm:16,md:24},children:[(0,a.jsx)(T.Z,{xxl:4,xl:6,lg:7,md:8,sm:10,xs:12,children:s.cloneElement(e,{style:{height:"100%"}})}),(0,a.jsx)(T.Z,{children:(0,a.jsx)("div",{style:{display:"flex",alignItems:"center",width:"100%",height:"100%"},children:c})})]})}},O=s.createContext(null);function Ve(i){var m=(0,s.useContext)(Me.ZP.ConfigContext),e=m.getPrefixCls,c=e("pro-steps-form"),p=He(c),M=p.wrapSSR,F=p.hashId,A=i.current,Ye=i.onCurrentChange,t=i.submitter,h=i.stepsFormRender,R=i.stepsRender,P=i.stepFormRender,g=i.stepsProps,x=i.onFinish,X=i.formProps,y=i.containerStyle,Oe=i.formRef,Ue=i.formMapRef,Xe=oe()(i,Je),K=(0,s.useRef)(new Map),j=(0,s.useRef)(new Map),C=(0,s.useRef)([]),Ke=(0,s.useState)([]),le=H()(Ke,2),S=le[0],ve=le[1],Qe=(0,s.useState)(!1),me=H()(Qe,2),I=me[0],b=me[1],Z=(0,se.YB)(),ke=(0,$e.default)(0,{value:i.current,onChange:i.onCurrentChange}),de=H()(ke,2),d=de[0],B=de[1],Q=(0,s.useMemo)(function(){return Ge[(g==null?void 0:g.direction)||"horizontal"]},[g==null?void 0:g.direction]),k=(0,s.useMemo)(function(){return d===S.length-1},[S.length,d]),we=(0,s.useCallback)(function(r,o){j.current.has(r)||ve(function(v){return[].concat(te()(v),[r])}),j.current.set(r,o)},[]),qe=(0,s.useCallback)(function(r){ve(function(o){return o.filter(function(v){return v!==r})}),j.current.delete(r),K.current.delete(r)},[]);(0,s.useImperativeHandle)(Ue,function(){return C.current},[C.current]),(0,s.useImperativeHandle)(Oe,function(){var r;return(r=C.current[d||0])===null||r===void 0?void 0:r.current},[d,C.current]);var _e=(0,s.useCallback)(function(){var r=ne()(W()().mark(function o(v,l){var $,E;return W()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(K.current.set(v,l),!(!k||!x)){f.next=3;break}return f.abrupt("return");case 3:return b(!0),$=Pe.T.apply(void 0,[{}].concat(te()(Array.from(K.current.values())))),f.prev=5,f.next=8,x($);case 8:E=f.sent,E&&(B(0),C.current.forEach(function(nr){var re;return(re=nr.current)===null||re===void 0?void 0:re.resetFields()})),f.next=15;break;case 12:f.prev=12,f.t0=f.catch(5),console.log(f.t0);case 15:return f.prev=15,b(!1),f.finish(15);case 18:case"end":return f.stop()}},o,null,[[5,12,15,18]])}));return function(o,v){return r.apply(this,arguments)}}(),[k,x,b,B]),w=(0,s.useMemo)(function(){var r=(0,je.n)(Ze.Z,"4.24.0")>-1,o=r?{items:S.map(function(v){var l=j.current.get(v);return u()({key:v,title:l==null?void 0:l.title},l==null?void 0:l.stepProps)})}:{};return(0,a.jsx)("div",{className:"".concat(c,"-steps-container ").concat(F).trim(),style:{maxWidth:Math.min(S.length*320,1160)},children:(0,a.jsx)(ae.Z,u()(u()(u()({},g),o),{},{current:d,onChange:void 0,children:!r&&S.map(function(v){var l=j.current.get(v);return(0,a.jsx)(ae.Z.Step,u()({title:l==null?void 0:l.title},l==null?void 0:l.stepProps),v)})}))})},[S,F,c,d,g]),D=(0,J.J)(function(){var r,o=C.current[d];(r=o.current)===null||r===void 0||r.submit()}),L=(0,J.J)(function(){d<1||B(d-1)}),q=(0,s.useMemo)(function(){return t!==!1&&(0,a.jsx)(V.ZP,u()(u()({type:"primary",loading:I},t==null?void 0:t.submitButtonProps),{},{onClick:function(){var o;t==null||(o=t.onSubmit)===null||o===void 0||o.call(t),D()},children:Z.getMessage("stepsForm.next","\u4E0B\u4E00\u6B65")}),"next")},[Z,I,D,t]),_=(0,s.useMemo)(function(){return t!==!1&&(0,a.jsx)(V.ZP,u()(u()({},t==null?void 0:t.resetButtonProps),{},{onClick:function(){var o;L(),t==null||(o=t.onReset)===null||o===void 0||o.call(t)},children:Z.getMessage("stepsForm.prev","\u4E0A\u4E00\u6B65")}),"pre")},[Z,L,t]),ee=(0,s.useMemo)(function(){return t!==!1&&(0,a.jsx)(V.ZP,u()(u()({type:"primary",loading:I},t==null?void 0:t.submitButtonProps),{},{onClick:function(){var o;t==null||(o=t.onSubmit)===null||o===void 0||o.call(t),D()},children:Z.getMessage("stepsForm.submit","\u63D0\u4EA4")}),"submit")},[Z,I,D,t]),er=(0,J.J)(function(){d>S.length-2||B(d+1)}),N=(0,s.useMemo)(function(){var r=[],o=d||0;if(o<1?S.length===1?r.push(ee):r.push(q):o+1===S.length?r.push(_,ee):r.push(_,q),r=r.filter(s.isValidElement),t&&t.render){var v,l={form:(v=C.current[d])===null||v===void 0?void 0:v.current,onSubmit:D,step:d,onPre:L};return t.render(l,r)}return t&&(t==null?void 0:t.render)===!1?null:r},[S.length,q,D,_,L,d,ee,t]),ce=(0,s.useMemo)(function(){return(0,Ie.default)(i.children).map(function(r,o){var v=r.props,l=v.name||"".concat(o),$=d===o,E=$?{contentRender:P,submitter:!1}:{};return(0,a.jsx)("div",{className:ue()("".concat(c,"-step"),F,z()({},"".concat(c,"-step-active"),$)),children:(0,a.jsx)(O.Provider,{value:u()(u()(u()(u()({},E),X),v),{},{name:l,step:o}),children:r})},l)})},[X,F,c,i.children,d,P]),fe=(0,s.useMemo)(function(){return R?R(S.map(function(r){var o;return{key:r,title:(o=j.current.get(r))===null||o===void 0?void 0:o.title}}),w):w},[S,w,R]),pe=(0,s.useMemo)(function(){return(0,a.jsxs)("div",{className:"".concat(c,"-container ").concat(F).trim(),style:y,children:[ce,h?null:(0,a.jsx)(De.Z,{children:N})]})},[y,ce,F,c,h,N]),rr=(0,s.useMemo)(function(){var r={stepsDom:fe,formDom:pe};return h?h(Q(r),N):Q(r)},[fe,pe,Q,h,N]);return M((0,a.jsx)("div",{className:ue()(c,F),children:(0,a.jsx)(ie.Z.Provider,u()(u()({},Xe),{},{children:(0,a.jsx)(Y.Provider,{value:{loading:I,setLoading:b,regForm:we,keyArray:S,next:er,formArrayRef:C,formMapRef:j,lastStep:k,unRegForm:qe,onFormFinish:_e},children:rr})}))}))}function U(i){return(0,a.jsx)(se._Y,{needDeps:!0,children:(0,a.jsx)(Ve,u()({},i))})}U.StepForm=Ne,U.useForm=ie.Z.useForm}}]);
