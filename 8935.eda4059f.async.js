"use strict";(self.webpackChunkpro_components=self.webpackChunkpro_components||[]).push([[8935],{28935:function(rr,he,t){t.d(he,{L:function(){return Y},b:function(){return V}});var pe=t(52510),N=t.n(pe),ge=t(57213),u=t.n(ge),Se=t(25359),$=t.n(Se),Fe=t(49811),_=t.n(Fe),ye=t(93525),ee=t.n(ye),xe=t(54306),z=t.n(xe),Re=t(12342),re=t.n(Re),ne=t(2420),Ce=t(76197),Pe=t(10760),H=t(36753),J=t(44520),W=t(6127),je=t(94321),Me=t(55262),te=t(93260),G=t(25836),De=t(14325),oe=t(70345),Ze=t(84875),se=t.n(Ze),Ae=t(81207),Ie=t(51060),i=t(50959),$e=t(35228),We=t(91757),a=t(11527),be=["onFinish","step","formRef","title","stepProps"];function Be(o){var m=(0,i.useRef)(),e=(0,i.useContext)(V),d=o.onFinish,Z=o.step,j=o.formRef,R=o.title,Ge=o.stepProps,S=re()(o,be);return(0,$e.noteOnce)(!S.submitter,"StepForm \u4E0D\u5305\u542B\u63D0\u4EA4\u6309\u94AE\uFF0C\u8BF7\u5728 StepsForm \u4E0A"),(0,i.useImperativeHandle)(j,function(){return m.current},[j==null?void 0:j.current]),(0,i.useEffect)(function(){if(o.name||o.step){var r=(o.name||o.step).toString();return e==null||e.regForm(r,o),function(){e==null||e.unRegForm(r)}}},[]),e&&e!==null&&e!==void 0&&e.formArrayRef&&(e.formArrayRef.current[Z||0]=m),(0,a.jsx)(We.I,u()({formRef:m,onFinish:function(){var r=_()($()().mark(function g(F){var y;return $()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(S.name&&(e==null||e.onFormFinish(S.name,F)),!d){p.next=9;break}return e==null||e.setLoading(!0),p.next=5,d==null?void 0:d(F);case 5:return y=p.sent,y&&(e==null||e.next()),e==null||e.setLoading(!1),p.abrupt("return");case 9:e!=null&&e.lastStep||e==null||e.next();case 10:case"end":return p.stop()}},g)}));return function(g){return r.apply(this,arguments)}}(),onInit:function(g,F){var y;m.current=F,e&&e!==null&&e!==void 0&&e.formArrayRef&&(e.formArrayRef.current[Z||0]=m),S==null||(y=S.onInit)===null||y===void 0||y.call(S,g,F)},layout:"vertical"},S))}var Le=Be,Te=t(3635),Ee=function(m){return N()({},m.componentCls,{"&-container":{width:"max-content",minWidth:"520px",maxWidth:"100%",margin:"auto"},"&-steps-container":N()({maxWidth:"1160px",margin:"auto"},"".concat(m.antCls,"-steps-vertical"),{height:"100%"}),"&-step":{display:"none",marginBlockStart:"32px","&-active":{display:"block"},"> form":{maxWidth:"100%"}}})};function Ne(o){return(0,Te.Xj)("StepsForm",function(m){var e=u()(u()({},m),{},{componentCls:".".concat(o)});return[Ee(e)]})}var ze=["current","onCurrentChange","submitter","stepsFormRender","stepsRender","stepFormRender","stepsProps","onFinish","formProps","containerStyle","formRef","formMapRef"],V=i.createContext(void 0),He={horizontal:function(m){var e=m.stepsDom,d=m.formDom;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(J.Z,{gutter:{xs:8,sm:16,md:24},children:(0,a.jsx)(W.Z,{span:24,children:e})}),(0,a.jsx)(J.Z,{gutter:{xs:8,sm:16,md:24},children:(0,a.jsx)(W.Z,{span:24,children:d})})]})},vertical:function(m){var e=m.stepsDom,d=m.formDom;return(0,a.jsxs)(J.Z,{align:"stretch",wrap:!0,gutter:{xs:8,sm:16,md:24},children:[(0,a.jsx)(W.Z,{xxl:4,xl:6,lg:7,md:8,sm:10,xs:12,children:i.cloneElement(e,{style:{height:"100%"}})}),(0,a.jsx)(W.Z,{children:(0,a.jsx)("div",{style:{display:"flex",alignItems:"center",width:"100%",height:"100%"},children:d})})]})}};function Je(o){var m=(0,i.useContext)(je.ZP.ConfigContext),e=m.getPrefixCls,d=e("pro-steps-form"),Z=Ne(d),j=Z.wrapSSR,R=Z.hashId,Ge=o.current,S=o.onCurrentChange,r=o.submitter,g=o.stepsFormRender,F=o.stepsRender,y=o.stepFormRender,x=o.stepsProps,p=o.onFinish,ie=o.formProps,ae=o.containerStyle,Ve=o.formRef,Ye=o.formMapRef,Oe=re()(o,ze),O=(0,i.useRef)(new Map),P=(0,i.useRef)(new Map),C=(0,i.useRef)([]),Xe=(0,i.useState)([]),ue=z()(Xe,2),h=ue[0],le=ue[1],Ke=(0,i.useState)(!1),ve=z()(Ke,2),A=ve[0],b=ve[1],M=(0,ne.YB)(),Qe=(0,Ie.default)(0,{value:o.current,onChange:o.onCurrentChange}),me=z()(Qe,2),c=me[0],B=me[1],X=(0,i.useMemo)(function(){return He[(x==null?void 0:x.direction)||"horizontal"]},[x==null?void 0:x.direction]),K=(0,i.useMemo)(function(){return c===h.length-1},[h.length,c]),Ue=(0,i.useCallback)(function(n,s){P.current.has(n)||le(function(v){return[].concat(ee()(v),[n])}),P.current.set(n,s)},[]),ke=(0,i.useCallback)(function(n){le(function(s){return s.filter(function(v){return v!==n})}),P.current.delete(n),O.current.delete(n)},[]);(0,i.useImperativeHandle)(Ye,function(){return C.current},[C.current]),(0,i.useImperativeHandle)(Ve,function(){var n;return(n=C.current[c||0])===null||n===void 0?void 0:n.current},[c,C.current]);var we=(0,i.useCallback)(function(){var n=_()($()().mark(function s(v,l){var I,E;return $()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(O.current.set(v,l),!(!K||!p)){f.next=3;break}return f.abrupt("return");case 3:return b(!0),I=Ce.T.apply(void 0,[{}].concat(ee()(Array.from(O.current.values())))),f.prev=5,f.next=8,p(I);case 8:E=f.sent,E&&(B(0),C.current.forEach(function(er){var q;return(q=er.current)===null||q===void 0?void 0:q.resetFields()})),f.next=15;break;case 12:f.prev=12,f.t0=f.catch(5),console.log(f.t0);case 15:return f.prev=15,b(!1),f.finish(15);case 18:case"end":return f.stop()}},s,null,[[5,12,15,18]])}));return function(s,v){return n.apply(this,arguments)}}(),[K,p,b,B]),Q=(0,i.useMemo)(function(){var n=(0,Pe.n)(Me.Z,"4.24.0")>-1,s=n?{items:h.map(function(v){var l=P.current.get(v);return u()({key:v,title:l==null?void 0:l.title},l==null?void 0:l.stepProps)})}:{};return(0,a.jsx)("div",{className:"".concat(d,"-steps-container ").concat(R).trim(),style:{maxWidth:Math.min(h.length*320,1160)},children:(0,a.jsx)(te.Z,u()(u()(u()({},x),s),{},{current:c,onChange:void 0,children:!n&&h.map(function(v){var l=P.current.get(v);return(0,a.jsx)(te.Z.Step,u()({title:l==null?void 0:l.title},l==null?void 0:l.stepProps),v)})}))})},[h,R,d,c,x]),D=(0,H.J)(function(){var n,s=C.current[c];(n=s.current)===null||n===void 0||n.submit()}),L=(0,H.J)(function(){c<1||B(c-1)}),U=(0,i.useMemo)(function(){return r!==!1&&(0,a.jsx)(G.ZP,u()(u()({type:"primary",loading:A},r==null?void 0:r.submitButtonProps),{},{onClick:function(){var s;r==null||(s=r.onSubmit)===null||s===void 0||s.call(r),D()},children:M.getMessage("stepsForm.next","\u4E0B\u4E00\u6B65")}),"next")},[M,A,D,r]),k=(0,i.useMemo)(function(){return r!==!1&&(0,a.jsx)(G.ZP,u()(u()({},r==null?void 0:r.resetButtonProps),{},{onClick:function(){var s;L(),r==null||(s=r.onReset)===null||s===void 0||s.call(r)},children:M.getMessage("stepsForm.prev","\u4E0A\u4E00\u6B65")}),"pre")},[M,L,r]),w=(0,i.useMemo)(function(){return r!==!1&&(0,a.jsx)(G.ZP,u()(u()({type:"primary",loading:A},r==null?void 0:r.submitButtonProps),{},{onClick:function(){var s;r==null||(s=r.onSubmit)===null||s===void 0||s.call(r),D()},children:M.getMessage("stepsForm.submit","\u63D0\u4EA4")}),"submit")},[M,A,D,r]),qe=(0,H.J)(function(){c>h.length-2||B(c+1)}),T=(0,i.useMemo)(function(){var n=[],s=c||0;if(s<1?h.length===1?n.push(w):n.push(U):s+1===h.length?n.push(k,w):n.push(k,U),n=n.filter(i.isValidElement),r&&r.render){var v,l={form:(v=C.current[c])===null||v===void 0?void 0:v.current,onSubmit:D,step:c,onPre:L};return r.render(l,n)}return r&&(r==null?void 0:r.render)===!1?null:n},[h.length,U,D,k,L,c,w,r]),de=(0,i.useMemo)(function(){return(0,Ae.default)(o.children).map(function(n,s){var v=n.props,l=v.name||"".concat(s),I=c===s,E=I?{contentRender:y,submitter:!1}:{};return(0,a.jsx)("div",{className:se()("".concat(d,"-step"),R,N()({},"".concat(d,"-step-active"),I)),children:i.cloneElement(n,u()(u()(u()(u()({},E),ie),v),{},{name:l,step:s,key:l}))},l)})},[ie,R,d,o.children,c,y]),ce=(0,i.useMemo)(function(){return F?F(h.map(function(n){var s;return{key:n,title:(s=P.current.get(n))===null||s===void 0?void 0:s.title}}),Q):Q},[h,Q,F]),fe=(0,i.useMemo)(function(){return(0,a.jsxs)("div",{className:"".concat(d,"-container ").concat(R).trim(),style:ae,children:[de,g?null:(0,a.jsx)(De.Z,{children:T})]})},[ae,de,R,d,g,T]),_e=(0,i.useMemo)(function(){var n={stepsDom:ce,formDom:fe};return g?g(X(n),T):X(n)},[ce,fe,X,g,T]);return j((0,a.jsx)("div",{className:se()(d,R),children:(0,a.jsx)(oe.Z.Provider,u()(u()({},Oe),{},{children:(0,a.jsx)(V.Provider,{value:{loading:A,setLoading:b,regForm:Ue,keyArray:h,next:qe,formArrayRef:C,formMapRef:P,lastStep:K,unRegForm:ke,onFormFinish:we},children:_e})}))}))}function Y(o){return(0,a.jsx)(ne._Y,{needDeps:!0,children:(0,a.jsx)(Je,u()({},o))})}Y.StepForm=Le,Y.useForm=oe.Z.useForm}}]);
