"use strict";(self.webpackChunkpro_components=self.webpackChunkpro_components||[]).push([[6627],{76627:function(rr,he,t){t.d(he,{L:function(){return V},b:function(){return G}});var pe=t(52510),E=t.n(pe),ge=t(57213),u=t.n(ge),Se=t(25359),I=t.n(Se),Fe=t(49811),_=t.n(Fe),ye=t(93525),ee=t.n(ye),xe=t(54306),N=t.n(xe),Re=t(12342),re=t.n(Re),ne=t(51312),Ce=t(43252),Pe=t(12542),z=t(24627),H=t(61110),$=t(524),je=t(61447),Me=t(31826),te=t(89241),J=t(85797),Ze=t(69753),oe=t(29098),De=t(84875),se=t.n(De),Ae=t(38606),Ie=t(44797),a=t(50959),$e=t(5795),We=t(1073),i=t(11527),be=["onFinish","step","formRef","title","stepProps"];function Be(o){var m=(0,a.useRef)(),e=(0,a.useContext)(G),d=o.onFinish,Z=o.step,Y=o.formRef,R=o.title,Ge=o.stepProps,S=re()(o,be);return(0,$e.noteOnce)(!S.submitter,"StepForm \u4E0D\u5305\u542B\u63D0\u4EA4\u6309\u94AE\uFF0C\u8BF7\u5728 StepsForm \u4E0A"),(0,a.useImperativeHandle)(Y,function(){return m.current}),(0,a.useEffect)(function(){if(o.name||o.step){var r=(o.name||o.step).toString();return e==null||e.regForm(r,o),function(){e==null||e.unRegForm(r)}}},[]),e&&e!==null&&e!==void 0&&e.formArrayRef&&(e.formArrayRef.current[Z||0]=m),(0,i.jsx)(We.I,u()({formRef:m,onFinish:function(){var r=_()(I()().mark(function g(F){var y;return I()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(S.name&&(e==null||e.onFormFinish(S.name,F)),!d){p.next=9;break}return e==null||e.setLoading(!0),p.next=5,d==null?void 0:d(F);case 5:return y=p.sent,y&&(e==null||e.next()),e==null||e.setLoading(!1),p.abrupt("return");case 9:e!=null&&e.lastStep||e==null||e.next();case 10:case"end":return p.stop()}},g)}));return function(g){return r.apply(this,arguments)}}(),onInit:function(g,F){var y;m.current=F,e&&e!==null&&e!==void 0&&e.formArrayRef&&(e.formArrayRef.current[Z||0]=m),S==null||(y=S.onInit)===null||y===void 0||y.call(S,g,F)},layout:"vertical"},S))}var Le=Be,Te=t(33698),Ee=function(m){return E()({},m.componentCls,{"&-container":{width:"max-content",minWidth:"520px",maxWidth:"100%",margin:"auto"},"&-steps-container":E()({maxWidth:"1160px",margin:"auto"},"".concat(m.antCls,"-steps-vertical"),{height:"100%"}),"&-step":{display:"none",marginBlockStart:"32px","&-active":{display:"block"},"> form":{maxWidth:"100%"}}})};function Ne(o){return(0,Te.Xj)("StepsForm",function(m){var e=u()(u()({},m),{},{componentCls:".".concat(o)});return[Ee(e)]})}var ze=["current","onCurrentChange","submitter","stepsFormRender","stepsRender","stepFormRender","stepsProps","onFinish","formProps","containerStyle","formRef","formMapRef"],G=a.createContext(void 0),He={horizontal:function(m){var e=m.stepsDom,d=m.formDom;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(H.Z,{gutter:{xs:8,sm:16,md:24},children:(0,i.jsx)($.Z,{span:24,children:e})}),(0,i.jsx)(H.Z,{gutter:{xs:8,sm:16,md:24},children:(0,i.jsx)($.Z,{span:24,children:d})})]})},vertical:function(m){var e=m.stepsDom,d=m.formDom;return(0,i.jsxs)(H.Z,{align:"stretch",wrap:!0,gutter:{xs:8,sm:16,md:24},children:[(0,i.jsx)($.Z,{xxl:4,xl:6,lg:7,md:8,sm:10,xs:12,children:a.cloneElement(e,{style:{height:"100%"}})}),(0,i.jsx)($.Z,{children:(0,i.jsx)("div",{style:{display:"flex",alignItems:"center",width:"100%",height:"100%"},children:d})})]})}};function Je(o){var m=(0,a.useContext)(je.ZP.ConfigContext),e=m.getPrefixCls,d=e("pro-steps-form"),Z=Ne(d),Y=Z.wrapSSR,R=Z.hashId,Ge=o.current,S=o.onCurrentChange,r=o.submitter,g=o.stepsFormRender,F=o.stepsRender,y=o.stepFormRender,x=o.stepsProps,p=o.onFinish,ae=o.formProps,ie=o.containerStyle,Ve=o.formRef,Ye=o.formMapRef,Oe=re()(o,ze),O=(0,a.useRef)(new Map),C=(0,a.useRef)(new Map),P=(0,a.useRef)([]),Xe=(0,a.useState)([]),ue=N()(Xe,2),h=ue[0],le=ue[1],Ke=(0,a.useState)(!1),ve=N()(Ke,2),D=ve[0],W=ve[1],j=(0,ne.YB)(),Qe=(0,Ie.Z)(0,{value:o.current,onChange:o.onCurrentChange}),me=N()(Qe,2),c=me[0],b=me[1],X=(0,a.useMemo)(function(){return He[(x==null?void 0:x.direction)||"horizontal"]},[x==null?void 0:x.direction]),K=(0,a.useMemo)(function(){return c===h.length-1},[h.length,c]),Ue=(0,a.useCallback)(function(n,s){C.current.has(n)||le(function(v){return[].concat(ee()(v),[n])}),C.current.set(n,s)},[]),ke=(0,a.useCallback)(function(n){le(function(s){return s.filter(function(v){return v!==n})}),C.current.delete(n),O.current.delete(n)},[]);(0,a.useImperativeHandle)(Ye,function(){return P.current}),(0,a.useImperativeHandle)(Ve,function(){var n;return(n=P.current[c||0])===null||n===void 0?void 0:n.current},[c]);var we=(0,a.useCallback)(function(){var n=_()(I()().mark(function s(v,l){var A,T;return I()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(O.current.set(v,l),!(!K||!p)){f.next=3;break}return f.abrupt("return");case 3:return W(!0),A=Ce.T.apply(void 0,[{}].concat(ee()(Array.from(O.current.values())))),f.prev=5,f.next=8,p(A);case 8:T=f.sent,T&&(b(0),P.current.forEach(function(er){var q;return(q=er.current)===null||q===void 0?void 0:q.resetFields()})),f.next=15;break;case 12:f.prev=12,f.t0=f.catch(5),console.log(f.t0);case 15:return f.prev=15,W(!1),f.finish(15);case 18:case"end":return f.stop()}},s,null,[[5,12,15,18]])}));return function(s,v){return n.apply(this,arguments)}}(),[K,p,W,b]),Q=(0,a.useMemo)(function(){var n=(0,Pe.n)(Me.Z,"4.24.0")>-1,s=n?{items:h.map(function(v){var l=C.current.get(v);return u()({key:v,title:l==null?void 0:l.title},l==null?void 0:l.stepProps)})}:{};return(0,i.jsx)("div",{className:"".concat(d,"-steps-container ").concat(R),style:{maxWidth:Math.min(h.length*320,1160)},children:(0,i.jsx)(te.Z,u()(u()(u()({},x),s),{},{current:c,onChange:void 0,children:!n&&h.map(function(v){var l=C.current.get(v);return(0,i.jsx)(te.Z.Step,u()({title:l==null?void 0:l.title},l==null?void 0:l.stepProps),v)})}))})},[h,R,d,c,x]),M=(0,z.J)(function(){var n,s=P.current[c];(n=s.current)===null||n===void 0||n.submit()}),B=(0,z.J)(function(){c<1||b(c-1)}),U=(0,a.useMemo)(function(){return r!==!1&&(0,i.jsx)(J.ZP,u()(u()({type:"primary",loading:D},r==null?void 0:r.submitButtonProps),{},{onClick:function(){var s;r==null||(s=r.onSubmit)===null||s===void 0||s.call(r),M()},children:j.getMessage("stepsForm.next","\u4E0B\u4E00\u6B65")}),"next")},[j,D,M,r]),k=(0,a.useMemo)(function(){return r!==!1&&(0,i.jsx)(J.ZP,u()(u()({},r==null?void 0:r.resetButtonProps),{},{onClick:function(){var s;B(),r==null||(s=r.onReset)===null||s===void 0||s.call(r)},children:j.getMessage("stepsForm.prev","\u4E0A\u4E00\u6B65")}),"pre")},[j,B,r]),w=(0,a.useMemo)(function(){return r!==!1&&(0,i.jsx)(J.ZP,u()(u()({type:"primary",loading:D},r==null?void 0:r.submitButtonProps),{},{onClick:function(){var s;r==null||(s=r.onSubmit)===null||s===void 0||s.call(r),M()},children:j.getMessage("stepsForm.submit","\u63D0\u4EA4")}),"submit")},[j,D,M,r]),qe=(0,z.J)(function(){c>h.length-2||b(c+1)}),L=(0,a.useMemo)(function(){var n=[],s=c||0;if(s<1?h.length===1?n.push(w):n.push(U):s+1===h.length?n.push(k,w):n.push(k,U),n=n.filter(a.isValidElement),r&&r.render){var v,l={form:(v=P.current[c])===null||v===void 0?void 0:v.current,onSubmit:M,step:c,onPre:B};return r.render(l,n)}return r&&(r==null?void 0:r.render)===!1?null:n},[h.length,U,M,k,B,c,w,r]),de=(0,a.useMemo)(function(){return(0,Ae.Z)(o.children).map(function(n,s){var v=n.props,l=v.name||"".concat(s),A=c===s,T=A?{contentRender:y,submitter:!1}:{};return(0,i.jsx)("div",{className:se()("".concat(d,"-step"),R,E()({},"".concat(d,"-step-active"),A)),children:a.cloneElement(n,u()(u()(u()(u()({},T),ae),v),{},{name:l,step:s,key:l}))},l)})},[ae,R,d,o.children,c,y]),ce=(0,a.useMemo)(function(){return F?F(h.map(function(n){var s;return{key:n,title:(s=C.current.get(n))===null||s===void 0?void 0:s.title}}),Q):Q},[h,Q,F]),fe=(0,a.useMemo)(function(){return(0,i.jsxs)("div",{className:"".concat(d,"-container ").concat(R),style:ie,children:[de,g?null:(0,i.jsx)(Ze.Z,{children:L})]})},[ie,de,R,d,g,L]),_e=(0,a.useMemo)(function(){var n={stepsDom:ce,formDom:fe};return g?g(X(n),L):X(n)},[ce,fe,X,g,L]);return Y((0,i.jsx)("div",{className:se()(d,R),children:(0,i.jsx)(oe.Z.Provider,u()(u()({},Oe),{},{children:(0,i.jsx)(G.Provider,{value:{loading:D,setLoading:W,regForm:Ue,keyArray:h,next:qe,formArrayRef:P,formMapRef:C,lastStep:K,unRegForm:ke,onFormFinish:we},children:_e})}))}))}function V(o){return(0,i.jsx)(ne._Y,{needDeps:!0,children:(0,i.jsx)(Je,u()({},o))})}V.StepForm=Le,V.useForm=oe.Z.useForm}}]);
